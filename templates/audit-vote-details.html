<!-- Vote metadata section -->
<section class="meta">
    <h3>Vote details</h3>
    <div class="box">
        <div class="row">
            <div class="label">
                {% if vote.is_pull_request %}
                    PR
                {% else %}
                    Issue
                {% endif %}
            </div>
            <div class="value">
                <a class="inline-link"
                   href="https://github.com/{{ vote.repository_full_name }}/{%- if vote.is_pull_request -%}pull{%- else -%}issues{%- endif -%}/{{ vote.issue_number }}"
                   target="_blank"
                   rel="noopener noreferrer">
                    {% if let Some(title) = vote.issue_title -%}
                        {{ title }} (#{{ vote.issue_number }})
                    {% else -%}
                        #{{ vote.issue_number }}
                    {% endif -%}
                    {% include "external-link-icon.html" %}
                </a>
            </div>
        </div>
        <div class="row">
            <div class="label">Created by</div>
            <div class="value">@{{ vote.created_by }}</div>
        </div>
        <div class="row">
            <div class="label">Created</div>
            <div class="value">{{ vote.created_at }}</div>
        </div>
        <div class="row">
            <div class="label">Closed</div>
            <div class="value">
                {% if let Some(closed_at) = vote.closed_at %}
                    {{ closed_at }}
                {% endif -%}
            </div>
        </div>
    </div>
</section>
<!-- Vote results data -->
<section>
    <h3>Results</h3>
    <div class="box">
        <div class="results-line">
            <span class="muted-700">In favor: <span class="badge">{{ "{:.0}"|format(results.in_favor_percentage) }}<span class="percentage">%</span></span></span>
            {% if results.passed %}
                <span class="badge pass">Passed</span>
            {% else %}
                <span class="badge fail">Failed</span>
            {% endif %}
            <span class="muted passing-threshold">Passing threshold: <span class="badge">{{ results.pass_threshold }}<span class="percentage">%</span></span></span>
        </div>
        <div class="progress" aria-hidden="true">
            <!-- djlint:off H008 -->
            <div class="bar {% if results.passed -%}passed{% else -%}failed{% endif -%}"
                 style='width:{{ "{:.2}"|format(results.in_favor_percentage) }}%'>
            </div>
            <!-- djlint:on H008 -->
        </div>
    </div>
</section>
<section>
    <h3>Summary</h3>
    <div class="summary">
        <div class="stat">
            <div class="label">In favor</div>
            <div class="value">{{ results.in_favor }}</div>
        </div>
        <div class="stat">
            <div class="label">Against</div>
            <div class="value">{{ results.against }}</div>
        </div>
        <div class="stat">
            <div class="label">Abstain</div>
            <div class="value">{{ results.abstain }}</div>
        </div>
        <div class="stat">
            <div class="label">Not voted</div>
            <div class="value">{{ results.not_voted }}</div>
        </div>
    </div>
</section>
<section class="votes">
    <h3>Binding votes</h3>
    <div class="table-wrap">
        <!-- Vote breakdown table -->
        <div class="modal-table">
            <table aria-label="Binding votes table">
                <thead>
                    <tr>
                        <th>USER</th>
                        <th>VOTE</th>
                        <th class="cell-date">DATE</th>
                    </tr>
                </thead>
                <tbody>
                    {% for (user, user_vote) in results.votes -%}
                        {% if user_vote.binding %}
                            <tr>
                                <td>@{{ user }}</td>
                                <td>
                                    <span class="vote-chip {% match user_vote.vote_option -%}{% when crate::results::VoteOption::InFavor %}favor{% when crate::results::VoteOption::Against %}against{% when crate::results::VoteOption::Abstain %}abstain{% endmatch %}">{{ user_vote.vote_option }}</span>
                                </td>
                                <td class="muted-700 cell-date">{{ user_vote.timestamp }}</td>
                            </tr>
                        {% endif %}
                    {% endfor -%}
                    {% if !results.pending_voters.is_empty() -%}
                        {% for user in results.pending_voters -%}
                            <tr>
                                <td>@{{ user }}</td>
                                <td>
                                    <span class="vote-chip not-voted">Not voted</span>
                                </td>
                                <td class="muted-700 cell-date"></td>
                            </tr>
                        {% endfor -%}
                    {% endif %}
                </tbody>
            </table>
        </div>
        <!-- /Vote breakdown table -->
    </div>
</section>
<!-- /Vote results data -->
